---
title: "ğŸ£ chap10. ëŒë‹¤ë¥¼ ì´ìš©í•œ ë„ë©”ì¸ ì „ìš© ì–¸ì–´"
author: olive-su
date: 2023-12-17 20:00:00 +09:00
categories: [ëª¨ë˜ ìë°” ì¸ ì•¡ì…˜, "chap10. ëŒë‹¤ë¥¼ ì´ìš©í•œ ë„ë©”ì¸ ì „ìš© ì–¸ì–´"]
tags: [ëª¨ë˜ ìë°” ì¸ ì•¡ì…˜, JAVA, 9ì£¼ì°¨, ê¹€ìˆ˜ê²½]
render_with_liquid: false
math: true
---

# chap10. ëŒë‹¤ë¥¼ ì´ìš©í•œ ë„ë©”ì¸ ì „ìš© ì–¸ì–´

# 10.1 ë„ë©”ì¸ ì „ìš© ì–¸ì–´

DSL(domain specific languages)ì€ ë²”ìš© í”„ë¡œê·¸ë˜ë° ì–¸ì–´ê°€ ì•„ë‹ˆë¼ íŠ¹ì • ë¹„ì¦ˆë‹ˆìŠ¤ ë„ë©”ì¸ì˜ ë¬¸ì œë¥¼ í•´ê²°í•˜ë ¤ê³  ë§Œë“  ì–¸ì–´ë‹¤.

íŠ¹ì • ë„ë©”ì¸ì—ë§Œ êµ­í•œë˜ë¯€ë¡œ ì˜¤ì§ ìì‹ ì˜ ë¬¸ì œë¥¼ ì–´ë–»ê²Œ í•´ê²°í• ì§€ì—ë§Œ ì§‘ì¤‘í•  ìˆ˜ ìˆê³  ë³µì¡ì„±ì„ ì˜ ë‹¤ë£° ìˆ˜ ìˆë‹¤.

- DSLì„ ê°œë°œí•˜ê¸° ìœ„í•´ í•„ìš”í•œ ì 
  - ì˜ì‚¬ ì†Œí†µì˜ ì™•: í”„ë¡œê·¸ë˜ë¨¸ê°€ ì•„ë‹Œ ì‚¬ëŒë„ ì´í•´í•  ìˆ˜ ìˆë„ë¡ ì½”ë“œì˜ ì˜ë„ê°€ ëª…í™•íˆ ì „ë‹¬ë˜ì–´ì•¼ í•¨(ì½”ë“œê°€ ë¹„ì¦ˆë‹ˆìŠ¤ ìš”êµ¬ì‚¬í•­ì— ë¶€í•©í•˜ëŠ”ì§€ í™•ì¸ ê°€ëŠ¥)
  - í•œ ë²ˆ ì½”ë“œë¥¼ êµ¬í˜„í•˜ì§€ë§Œ ì—¬ëŸ¬ë²ˆ ì½ëŠ”ë‹¤: ê°€ë…ì„±ì€ ìœ ì§€ë³´ìˆ˜ì˜ í•µì‹¬. ë™ë£Œê°€ ì‰½ê²Œ ì´í•´í•  ìˆ˜ ìˆë„ë¡ ì½”ë“œ êµ¬í˜„ í•„ìˆ˜

### **ì¥ì **

- ê°„ê²°í•¨
- ê°€ë…ì„±
- ìœ ì§€ë³´ìˆ˜
- ë†’ì€ ìˆ˜ì¤€ì˜ ì¶”ìƒí™”
- ì§‘ì¤‘
- ê´€ì‹¬ì‚¬ ë¶„ë¦¬(Separation of concerns)

### **ë‹¨ì **

- DLS ì„¤ê³„ì˜ ì–´ë ¤ì›€
- ê°œë°œ ë¹„ìš©
- ì¶”ê°€ ìš°íšŒ ê³„ì¸µ
- ìƒˆë¡œ ë°°ì›Œì•¼ í•˜ëŠ” ì–¸ì–´
- í˜¸ìŠ¤íŒ… ì–¸ì–´ í•œê³„

### **ë‚´ë¶€ DSL**

- ìˆœìˆ˜ ìë°”ì½”ë“œ ê°™ì€ ê¸°ì¡´ í˜¸ìŠ¤íŒ… ì–¸ì–´ë¥¼ ê¸°ë°˜ìœ¼ë¡œ êµ¬í˜„í•œ DSL
- ìœ ì—°ì„±ì´ ë–¨ì–´ì§€ê¸° ë•Œë¬¸ì— ê°„ë‹¨í•˜ê³  í‘œí˜„ë ¥ ìˆëŠ” DSLì„ ë§Œë“œëŠ”ë° í•œê³„ê°€ ìˆì—ˆì§€ë§Œ ëŒë‹¤ í‘œí˜„ì‹ì´ ë“±ì¥í•˜ë©´ì„œ ì–´ëŠì •ë„ í•´ê²°ë  ìˆ˜ ìˆìŒ
- ìˆœìˆ˜ ìë°”ë¡œ DSL ì„ êµ¬í˜„ ì‹œ ì¥ì 
  - ì™¸ë¶€ DSLì— ë¹„í•´ ìƒˆë¡œìš´ íŒ¨í„´ê³¼ ê¸°ìˆ ì„ ë°°ì›Œ DSLì„ êµ¬í˜„í•˜ëŠ” ë…¸ë ¥ì´ ê°ì†Œ
  - ìˆœìˆ˜ ìë°”ë¡œ DSL ì„ êµ¬í˜„í•˜ë©´ ë‚˜ë¨¸ì§€ ì½”ë“œì™€ í•¨ê»˜ ì»´íŒŒì¼ ê°€ëŠ¥. (ë‹¤ë¥¸ ì–¸ì–´ì˜ ì»´íŒŒì¼ëŸ¬ ë˜ëŠ” ì™¸ë¶€ DSLì„ ë§Œë“œëŠ” ë„êµ¬ë¥¼ ì‚¬ìš©í•˜ì§€ ì•Šì•„ë„ ë¨)
  - ìƒˆë¡œìš´ ì–¸ì–´ë¥¼ ë°°ìš°ê±°ë‚˜ ë³µì¡í•œ ì™¸ë¶€ ë„êµ¬ë¥¼ ë°°ìš¸ í•„ìš”ê°€ ì—†ìŒ
  - DSL ì‚¬ìš©ìëŠ” ê¸°ì¡´ì˜ ìë°” IDEë¡œ ìë™ ì™„ì„±, ë¦¬íŒ©í„°ë§ ê¸°ëŠ¥ ê·¸ëŒ€ë¡œ ì‚¬ìš© ê°€ëŠ¥
  - ì¶”ê°€ DSLì„ ì‰½ê²Œ í•©ì¹  ìˆ˜ ìˆìŒ

### **ë‹¤ì¤‘ DSL**

ìë°”ëŠ” ì•„ë‹ˆì§€ë§Œ JVMì—ì„œ ì‹¤í–‰ë˜ë©° ë” ìœ ì—°í•˜ê³  í‘œí˜„ë ¥ì´ ê°€ëŠ¥í•œ ì–¸ì–´(ex. ìŠ¤ì¹¼ë¼, ê·¸ë£¨ë¹„â€¦)ë¡œ êµ¬í˜„í•œ DSL

ì½”í‹€ë¦°, ì‹¤ë¡  ê°™ì´ ìŠ¤ì¹¼ë¼ì™€ í˜¸í™˜ì„±ì´ ìœ ì§€ë˜ë©° ë‹¨ìˆœí•˜ê³  ì‰½ê²Œ ë°°ìš¸ ìˆ˜ ìˆëŠ” ìƒˆ ì–¸ì–´ë„ ì¡´ì¬í•œë‹¤.

ì´ ì–¸ì–´ë“¤ì€ ëª¨ë‘ ìë°”ë³´ë‹¤ ì ‹ìœ¼ë©° ì œì•½ì„ ì¤„ì´ê³ , ê°„í¸í•œ ë¬¸ë²•ì„ ì§€í–¥í•˜ë„ë¡ ì„¤ê³„ë˜ì—ˆë‹¤.

DSL ì¹œí™”ì ì´ì§€ë§Œ ë‹¤ìŒê³¼ ê°™ì€ ë‹¨ì ë“¤ì´ ì¡´ì¬í•œë‹¤.

- ìƒˆë¡œìš´ í”„ë¡œê·¸ë˜ë° ì–¸ì–´ë¥¼ ë°°ìš°ê±°ë‚˜ ëˆ„êµ°ê°€ í•´ë‹¹ ê¸°ìˆ ì„ ì§€ë‹ˆê³  ìˆì–´ì•¼ í•¨
- ë‘ ê°œ ì´ìƒì˜ ì–¸ì–´ê°€ í˜¼ì¬í•˜ë¯€ë¡œ ì—¬ëŸ¬ ì»´íŒŒì¼ëŸ¬ë¡œ ì†ŒìŠ¤ë¥¼ ë¹Œë“œí•˜ë„ë¡ ë¹Œë“œ ê³¼ì •ì„ ê°œì„ í•´ì•¼ í•¨
- JVM ì—ì„œ ì‹¤í–‰ë˜ì§€ë§Œ ìë°”ì™€ í˜¸í™˜ì„±ì´ ì™„ë²½í•˜ì§€ ì•Šì€ ê²½ìš°ê°€ ë§ìŒ (ì„±ëŠ¥ ì†ì‹¤ ê°€ëŠ¥)

### **ì™¸ë¶€ DSL**

- ìŠ¤íƒ ë“œì–´ë¡ (standalone)
- í˜¸ìŠ¤íŒ… ì–¸ì–´ì™€ëŠ” ë…ë¦½ì ìœ¼ë¡œ ìì²´ì˜ ë¬¸ë²•ì„ ê°€ì§€ëŠ” DSL

ìì‹ ë§Œì˜ ë¬¸ë²•ê³¼ êµ¬ë¬¸ìœ¼ë¡œ ìƒˆ ì–¸ì–´ë¥¼ ì„¤ê³„í•´ì•¼ í•˜ê³  ì–¸ì–´ íŒŒì‹±, íŒŒì„œì˜ ê²°ê³¼ ë¶„ì„, ì™¸ë¶€ DSL ì‹¤í–‰í•  ì½”ë“œë¥¼ ë§Œë“¤ì–´ì•¼ í•¨

ì´ ë°©ë²•ì„ ì„ íƒí•´ì•¼ í•œë‹¤ë©´ ANTLR ê°™ì€ ìë°” ê¸°ë°˜ íŒŒì„œ ìƒì„±ê¸°ë¥¼ ì´ìš©í•˜ë©´ ë„ì›€ì„ ë°›ì„ ìˆ˜ ìˆìŒ

- ì¥ì 
  - ë¬´í•œí•œ ìœ ì—°ì„±ì„ ê°€ì§
  - í•„ìš”í•œ íŠ¹ì„±ì„ ì™„ë²½í•˜ê²Œ ì œê³µí•˜ëŠ” ì–¸ì–´ë¡œ ì„¤ê³„ ê°€ëŠ¥
  - ë¹„ì¦ˆë‹ˆìŠ¤ ë¬¸ì œë¥¼ ë¬˜ì‚¬í•˜ê³  í•´ê²°í•˜ëŠ” ê°€ë…ì„± ì¢‹ì€ ì–¸ì–´ ì„ íƒ ê°€ëŠ¥
  - ìë°”ë¡œ ê°œë°œëœ ì¸í”„ë¼êµ¬ì¡° ì½”ë“œì™€ ë¹„ì¦ˆë‹ˆìŠ¤ ì½”ë“œë¥¼ ëª…í™•í•˜ê²Œ ë¶„ë¦¬ ê°€ëŠ¥
- ë‹¨ì 
  - ì¼ë°˜ì ì¸ ì‘ì—…ì´ ì•„ë‹ˆë©° ì‰½ê²Œ ê¸°ìˆ ì„ ì–»ì„ ìˆ˜ ì—†ìŒ
  - ì‘ì—…ì´ ë³µì¡í•˜ê³  ì œì–´ ë²”ìœ„ë¥¼ ì‰½ê²Œ ë²—ì–´ë‚  ìˆ˜ ìˆìŒ
  - ì²˜ìŒ ì„¤ê³„í•œ ëª©ì ì„ ë²—ì–´ë‚˜ëŠ” ê²½ìš°ê°€ ë§ìŒ
  - DSLê³¼ í˜¸ìŠ¤íŠ¸ ì–¸ì–´ ì‚¬ì´ì— ì¸ê³µ ê³„ì¸µì´ ìƒê¹€

# 10.2 ìµœì‹  ìë°” APIì˜ ì‘ì€ DSL

ë„¤ì´í‹°ë¸Œ ìë°” API ì—ëŠ” ìë°” ìƒˆë¡œìš´ ê¸°ëŠ¥ì˜ ì¥ì ë“¤ì´ ì ìš©ë˜ì—ˆë‹¤.

ìŠ¤íŠ¸ë¦¼ API ë¥¼ í†µí•´ DSL ì´ ì‚¬ìš©ëœ ì˜ˆë¥¼ í™•ì¸í•œë‹¤.

### **ìŠ¤íŠ¸ë¦¼ APIëŠ” ì»¬ë ‰ì…˜ì„ ì¡°ì‘í•˜ëŠ” DSL**

`Stream`Â ì¸í„°í˜ì´ìŠ¤ëŠ” ë„¤ì´í‹°ë¸Œ ìë°” API ì— ì‘ì€ ë‚´ë¶€ DSLì„ ì ìš©í•œ ì¢‹ì€ ì˜ˆë‹¤.

ì»¬ë ‰ì…˜ì˜ í•­ëª©ì„ í•„í„°, ì •ë ¬, ë³€í™˜, ê·¸ë£¹í™”, ì¡°ì‘í•˜ëŠ” ì‘ì§€ë§Œ ê°•ë ¥í•œ DSL ì´ë‹¤.

`Stream`Â ì¸í„°í˜ì´ìŠ¤ë¥¼ ì´ìš©í•˜ì—¬ í•¨ìˆ˜í˜•ìœ¼ë¡œ êµ¬í˜„í•˜ë©´ ì‰½ê³  ê°„ê²°í•˜ë‹¤.

ìŠ¤íŠ¸ë¦¼ APIì˜ í”Œë£¨ì–¸íŠ¸ í˜•ì‹ ë˜í•œ ì„¤ê³„ëœ DSLì˜ íŠ¹ì§• ì¤‘ í•˜ë‚˜ì´ë‹¤.(ì¤‘ê°„ ì—°ì‚° ê²Œìœ¼ë¦„, ë‹¤ë¥¸ ì—°ì‚°ìœ¼ë¡œ íŒŒì´í”„ë¼ì¸ ê°€ëŠ¥)

```java
**Files.**lines**(Paths.**get**(**fileName**)).**filter**(**line **->** line**.**startWith**(**"ERROR"**)).**limit**(**40**).**collect**(**toList**());**
```

### **ë°ì´í„°ë¥¼ ìˆ˜ì§‘í•˜ëŠ” DSLì¸ Collectors**

`Collector`Â ì¸í„°í˜ì´ìŠ¤ëŠ” ë°ì´í„° ìˆ˜ì§‘(ìˆ˜ì§‘, ê·¸ë£¹í™”, íŒŒì´ì…˜)ì„ ìˆ˜í–‰í•˜ëŠ” DSLë¡œ ê°„ì£¼í•  ìˆ˜ ìˆë‹¤.

íŠ¹íˆ ë‹¤ì¤‘ í•„ë“œ ì •ë ¬ì„ ì§€ì›í•˜ë„ë¡ í•©ì³ì§ˆ ìˆ˜ ìˆìœ¼ë©°,Â `Collectors`Â ëŠ” ë‹¤ì¤‘ ìˆ˜ì¤€ ê·¸ë£¹í™”ë¥¼ ë‹¬ì„±í•  ìˆ˜ ìˆë„ë¡ í•©ì³ì§ˆ ìˆ˜ ìˆë‹¤.

```java
**Map<String,** **Map<Color,** **List<Car>>>** carsByBrandAndColor **=** cars**.**stream**().**collect**(**grouping**(**Car:**:**getBrand**,** groupingBy**(**Car:**:**getColor**)));**

*// ë‘ Comparators ì—°ê²°*
**Comparator<Person>** comparator **=** comparing**(**Person:**:**getAge**).**thenComparing**(**Person:**:**getName**);**

*// ì¤‘ì²©*
**Collector<?** **super** **Car,** **?,** **Map<Brand,** **Map<Color,** **List<Car>>>>** carGroupingCollector **=**groupingBy**(**Car:**:**getBrand**,** groupingBy**(**Car:**:**getColor**));**
```

# 10.3 ìë°”ë¡œ DSLì„ ë§Œë“œëŠ” íŒ¨í„´ê³¼ ê¸°ë²•

- ì£¼ì‹ ê°€ê²©ì„ ëª¨ë¸ë§í•˜ëŠ” ìˆœìˆ˜ ìë°” ë¹ˆì¦ˆ

```java
public class Stock {
    private String symbol;
    private String market;
    public String getSymbol(){
        return symbol;
    }
    public void setSymbol(String symbol) {
        this.symbol = symbol;
    }
    ...
}
public class Trade {
    public enum Type { BUY, SELL }

    private Type type;
    private Stock stock;
    private int quantity;
    private double price;
    ...
}

public class Order {
    private String customer;
    private List<Trade> trades = new ArrayList<>();
    ...
}
```

ì£¼ë¬¸ ìƒì„± ì½”ë“œ

```java
Order order = new Order();
order.setCustomer("BigBank");

Trade trade1 = new Trade();
trade1.setType(Trade.Type.Buy);

Stock stock1 = new Stock();
stock1.setSymbol("IBM");
stock1.setMarket("NYSE");

trade.setStock(stock1);
...
```

í•˜ì§€ë§Œ ì´ëŸ¬í•œ ì½”ë“œëŠ” ì¥í™©í•˜ê³  ë¹„ê°œë°œìì¸ ë„ë©”ì¸ ì „ë¬¸ê°€ê°€ ì´í•´í•˜ê³  ê²€ì¦í•˜ê¸° ì–´ë µë‹¤.

ì§ê´€ì ìœ¼ë¡œ ë„ë©”ì¸ ëª¨ë¸ì„ ë°˜ì˜í•  ìˆ˜ ìˆëŠ” DSL ì´ í•„ìš”í•˜ë‹¤. ì´ ì±…ì—ì„œëŠ” ë‹¤ìŒê³¼ ê°™ì€ DSL íŒ¨í„´ë“¤ì„ ì†Œê°œí•˜ê³  ìˆë‹¤.

- ë©”ì„œë“œ ì²´ì¸
- ì¤‘ì²©ëœ í•¨ìˆ˜
- ëŒë‹¤ í‘œí˜„ì‹ì„ ì´ìš©í•œ í•¨ìˆ˜ ì‹œí€€ì‹±

### **ë©”ì„œë“œ ì²´ì¸**

ë©”ì„œë“œ ì²´ì¸ì€ DSL ì—ì„œ ê°€ì¥ í”í•œ ë°©ì‹ ì¤‘ í•˜ë‚˜ì´ë‹¤.

- ì¥ì 

  - ì‚¬ìš©ìê°€ ì§€ì •ëœ ì ˆì°¨ì— ë”°ë¼ í”Œë£¨ì–¸íŠ¸ APIì˜ ë©”ì„œë“œ í˜¸ì¶œì„ ê°•ì œ
  - íŒŒë¼ë¯¸í„°ê°€ ë¹Œë” ë‚´ë¶€ë¡œ êµ­í•œ ë¨
  - ë©”ì„œë“œ ì´ë¦„ì´ ì¸ìˆ˜ì˜ ì´ë¦„ì„ ëŒ€ì‹ í•˜ì—¬ ê°€ë…ì„± ê°œì„ 
  - ë¬¸ë²•ì  ì¡ìŒì´ ìµœì†Œí™”
  - ì„ íƒí˜• íŒŒë¼ë¯¸í„°ì™€ ì˜ ë™ì‘
  - ì •ì  ë©”ì„œë“œ ì‚¬ìš©ì„ ìµœì†Œí™”í•˜ê±°ë‚˜ ì—†ì•¨ ìˆ˜ ìˆìŒ

- ë‹¨ì 
  - ë¹Œë”ë¥¼ êµ¬í˜„í•´ì•¼ í•¨
  - ìƒìœ„ ìˆ˜ì¤€ì˜ ë¹Œë”ë¥¼ í•˜ìœ„ ìˆ˜ì¤€ì˜ ë¹Œë”ì™€ ì—°ê²°í•  ë§ì€ ì ‘ì°© ì½”ë“œê°€ í•„ìš”
  - ë„ë©˜ì¸ ê°ì²´ì˜ ì¤‘ì²© êµ¬ì¡°ì™€ ì¼ì¹˜í•˜ê²Œ ë“¤ì—¬ì“°ê¸°ë¥¼ ê°•ì œí•  ìˆ˜ ì—†ìŒ

```java
Order order = forCustomer("BigBank")
    .buy(80)
    .stock("IBM")
    .on("NYSE")
    ...
    .end();
```

â‡’ ìµœìƒ ìˆ˜ì¤€ ë¹Œë”ë¥¼ ë§Œë“¤ê³  ì£¼ë¬¸ì„ ê°ì‹¸ì„œ ê±°ë˜ë¥¼ ì¶”ê°€í•  ìˆ˜ ìˆë„ë¡ í•´ì•¼ í•¨

```java
public class MethodChainingOrderBuilder {

    public final Order order = new Order();

    private MethodChainingOrderBuilder(String customer) {
        order.setCustomer(customer);
    }
    public static MethodChainingOrderBuilder forCustomer(String customer) {
        return new MethodChainingOrderBuilder(customer);
    }
    public TradeBuilder buy(int quantity) {
        return new TradeBuilder(this, Trade.Type.SELL, quantity);
    }
    public MethodChainingOrderBuilder addTrade(Trade trade) {
        order.addTrade(trade);
        return this;
    }
    public Order end() {
        return order;
    }
}

public class TradeBuilder {
    private final MethodChainingOrderBuilder builder;
    public final Trade trade = new Trade();

    private TradeBuilder(MethodChainingOrderBuilder builder, Trade.Type type, int quantity) {
        this.builder = builder;
        trade.setType(type);
        trade.setQuantity(quantity);
    }
    public StockBuilder stock(String symbol) {
        return new StockBuilder(builder, trade, symbol);
    }
}

public class StockBuilder {
    private final MethodChainingOrderBuilder builder;
    private final Trade trade;
    private final Stock stock = new Stock();

    private StockBuilder(MethodChainingOrderBuilder builder, Trade trade, String symbol) {
        this.builder = builder;
        this.trade = trade;
        stock.setSymbol(symbol);
    }
    public TradeBuilderWithStock on(String market) {
        stock.setMarket(market);
        trade.setStock(stock);
        return new TradeBuilderWithStock(builder, trade);
    }
}

public class TradeBuilderWithStock {
    private final MethodChainingOrderBuilder builder;
    private final Trade trade;

    public TradeBuilderWithStock(MethodChainingOrderBuilder builder, Trade trade) {
        this.builder = builder;
        this.trade = trade;
    }
    public MethodChainingOrderBuilder at(double price) {
        trade.setPrice(price);
        return builder.addTrade(trade);
    }
}
```

### **ì¤‘ì²©ëœ í•¨ìˆ˜ ì´ìš©**

ì¤‘ì²©ëœ í•¨ìˆ˜ DSL íŒ¨í„´ì€ ë‹¤ë¥¸ í•¨ìˆ˜ ì•ˆì— í•¨ìˆ˜ë¥¼ ì´ìš©í•´ ë„ë©”ì¸ ëª¨ë¸ì„ ë§Œë“ ë‹¤.

- ì¥ì 
  - ì¤‘ì²© ë°©ì‹ì´ ë„ë©”ì¸ ê°ì²´ ê³„ì¸µ êµ¬ì¡°ì— ê·¸ëŒ€ë¡œ ë°˜ì˜
  - êµ¬í˜„ì˜ ì¥í™©í•¨ì„ ì¤„ì¼ ìˆ˜ ìˆìŒ
- ë‹¨ì 
  - ê²°ê³¼ DSL ì— ë” ë§ì€ ê´„í˜¸ë¥¼ ì‚¬ìš©
  - ì •ì  ë©”ì„œë“œ ì‚¬ìš©ì´ ë¹ˆë²ˆ
  - ì¸ìˆ˜ ëª©ë¡ì„ ì •ì  ë©”ì„œë“œì— ë„˜ê²¨ì¤˜ì•¼ í•¨
  - ì¸ìˆ˜ì˜ ì˜ë¯¸ê°€ ì´ë¦„ì´ ì•„ë‹ˆë¼ ìœ„ì¹˜ì— ì˜í•´ ì •ì˜ ë¨
  - ë„ë©”ì¸ì— ì„ íƒ ì‚¬í•­ í•„ë“œê°€ ìˆìœ¼ë©´ ì¸ìˆ˜ë¥¼ ìƒëµí•  ìˆ˜ ìˆìœ¼ë¯€ë¡œ ë©”ì„œë“œ ì˜¤ë²„ë¡œë”© í•„ìš”

```java
Order order = order("BigBank",
                    buy(80, stock("IBM", on("NYSE")), at(125.00)),
                    sell(50, stock("GOOGLE", on("NASDAQ")), at(375.00))
                    );
```

êµ¬í˜„ ì½”ë“œ

```java
public class NestedFunctionOrderBuilder {

    public static Order order(String customer, Trade... trades) {
        Order order = new Order();
        order.setCustomer(customer);
        Stream.of(trades).forEach(order::addTrade);
        return order;
    }
    public static Trade buy(int quantity, Stock stock, double price) {
        return buildTrade(quantity, stock, price, Trade.Type.BUY);
    }
    private static Trade buildTrade(int quantity, Stock stock, double price, Trade.Type type) {
        Trade trade = new Trade();
        trade.setQuantity(quantity);
        trade.setType(type);
        trade.setStock(stock);
        trade.setPrice(price);
        return trade;
    }
    public static double at(double price) {
        return price;
    }
    publid static Stock stock(String Symbol, String market) {
        Stock stock = new Stock();
        stock.setSymbol(symbol);
        stock.setMarket(market);
        return stock;
    }
}
```

### **ëŒë‹¤ í‘œí˜„ì‹ì„ ì´ìš©í•œ í•¨ìˆ˜ ì‹œí€€ì‹±**

ëŒë‹¤ í‘œí˜„ì‹ìœ¼ë¡œ ì •ì˜í•œ í•¨ìˆ˜ ì‹œí€€ìŠ¤ë¥¼ ì‚¬ìš©í•œë‹¤.

- ì¥ì 
  - í”Œë£¨ì–¸íŠ¸ ë°©ì‹ìœ¼ë¡œ ë„ë©”ì¸ ê°ì²´ ì •ì˜ ê°€ëŠ¥
  - ì¤‘ì²© ë°©ì‹ì´ ë„ë©”ì¸ ê°ì²´ ê³„ì¸µ êµ¬ì¡°ì— ê·¸ëŒ€ë¡œ ë°˜ì˜
  - ì„ íƒí˜• íŒŒë¼ë¯¸í„°ì™€ ì˜ ë™ì‘
  - ì •ì  ë©”ì„œë“œë¥¼ ìµœì†Œí™”í•˜ê±°ë‚˜ ì—†ì•¨ ìˆ˜ ìˆìŒ
  - ë¹Œë”ì˜ ì ‘ì°© ì½”ë“œê°€ ì—†ìŒ
- ë‹¨ì 
  - ì„¤ì • ì½”ë“œê°€ í•„ìš”
  - ëŒë‹¤ í‘œí˜„ì‹ ë¬¸ë²•ì— ì˜í•œ ì¡ìŒì˜ ì˜í–¥ì„ ë°›ìŒ

### **ì¡°í•©í•˜ê¸°**

ì¤‘ì²©ëœ í•¨ìˆ˜ íŒ¨í„´ê³¼ ëŒë‹¤ ê¸°ë²•ì„ í˜¼ìš©í•˜ë©´ ë‹¤ìŒê³¼ ê°™ì´ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.

- ì¥ì 
  - ê°€ë…ì„± í–¥ìƒ
- ë‹¨ì 
  - ì—¬ëŸ¬ ê¸°ë²•ì„ í˜¼ìš©í–ˆê¸° ë•Œë¬¸ì— ì‚¬ìš©ìê°€ DSLì„ ë°°ìš°ëŠ” ì‹œê°„ì´ ì˜¤ë˜ ê±¸ë¦¼
