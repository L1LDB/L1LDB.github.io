---
title: "🦊 chap1. 자바 8, 9, 10, 11 : 무슨 일이 일어나고 있는가?"
author: gengminy
date: 2023-09-23 20:00:00 +09:00
categories:
  [모던 자바 인 액션, "chap1. 자바 8, 9, 10, 11 : 무슨 일이 일어나고 있는가?"]
tags: [모던 자바 인 액션, JAVA, 1주차, 노경민]
render_with_liquid: false
math: true
---

## 1.1 역사의 흐름은 무엇인가?

자바 역사를 통틀어 가장 큰 변화가 자바 8에서 일어났다.

![](https://github.com/L1LDB/L1LDB.github.io/blob/main/_posts/modern-java-in-action/chap1.-자바-8,-9,-10,-11-:-무슨-일이-일어나고-있는가?/2023-09-23-노경민/1.png)

이런 고전적인 코드는 자바 8에서 아래처럼 바뀌었다.

![](https://github.com/L1LDB/L1LDB.github.io/blob/main/_posts/modern-java-in-action/chap1.-자바-8,-9,-10,-11-:-무슨-일이-일어나고-있는가?/2023-09-23-노경민/2.png)

자바 8은 간결한 코드, 멀티코어 프로세서의 쉬운 활용이라는 두 가지 요구사항을 기반으로 한다.

자바 8에서 제공하는 새로운 기술은 다음과 같다.

- 스트림 API
- 메서드에 코드를 전달하는 기법
- 인터페이스의 디폴트 메서드

자바 8은 데이터베이스 질의 언어에서 표현식을 처리하는 것처럼 병렬 연산을 지원하는 스트림이라는 새로운 API 를 제공한다.

고수준 언어로 원하는 동작을 표현하면, 구현부에서 최적의 저수준 실행 방법을 선택하는 방식으로 동작한다.

스트림을 이용하면 에러를 자주 일으키고 비용이 훨씬 비싼 `synchronized` 키워드를 사용하지 않아도 된다.

메서드에 코드를 전달하는 기법을 이용하면 동작 파라미터화를 손쉽게 구현할 수 있다.

이는 함수형 프로그래밍에서 위력을 발휘한다.

## 1.2 왜 아직도 자바는 진화하는가?

### 1.2.1 프로그래밍 언어 생태계에서 자바의 위치

자바는 출발이 좋았다.

처음부터 많은 유용한 라이브러리를 포함하는 잘 설계된 객체지향 언어로 시작했다.

스레드와 락을 이용한 소소한 동시성도 지원했다.

하지만 빅데이터라는 도전에 직면하면서 병렬 프로세싱을 활용해야 하는데,

지금까지의 자바로는 충분히 대응할 수 없었다.

자바 8에 추가된 기능은 자바에 없던 완전히 새로운 개념이지만

현재 시장에서 요구하는 기능을 효과적으로 제공한다.

### 1.2.2 스트림 처리

스트림이란 한 번에 한 개씩 만들어지는 연속적인 데이터 항목들의 모임이다.

![](https://github.com/L1LDB/L1LDB.github.io/blob/main/_posts/modern-java-in-action/chap1.-자바-8,-9,-10,-11-:-무슨-일이-일어나고-있는가?/2023-09-23-노경민/3.png)

유닉스에서는 자동차 생산 공장 라인처럼 순차적으로 데이터를 전송하지만
각 작업장에서는 동시에 작업을 처리한다.

자바 8에서는 `java.util.stream` 패키지에 스트림 API가 추가되었다.

스트림 API 는 파이프라인을 만드는 데 필요한 많은 메서드를 제공한다.

우리는 작업을 고수준으로 추상화해서 일련의 스트림으로 만들어 처리할 수 있다.

또한 스레드라는 복잡한 작업을 사용하지 않으면서도 공짜로 병렬성을 얻을 수 있다.

### 1.2.3 동작 파라미터화로 메서드에 코드 전달하기

자바 8 이전에는 메서드를 다른 메서드로 전달할 방법이 없었다.

자바 8에서는 메서드를 다른 메서드의 인수로 넘겨주는 기능을 제공한다.

이러한 기능을 이론적으로 동작 파라미터화(behavior parameterization)라고 부른다

### 1.2.4 병렬성과 공유 가변 데이터

보통 다른 코드와 동시에 실행하더라도 안전하게 실행할 수 있는 코드를 만들려면 공유된 가변 데이터에 접근하지 않아야 한다.

이러한 함수를 순수 함수, 부작용없는 함수, 무상태 함수라고 부른다.

자바 8 스트림을 활용하면 기존의 자바 스레드 API (synchronized)보다 쉽게 병렬성을 활용할 수 있다.

### 1.2.5 자바가 진화해야 하는 이유

많은 이는 자바의 변화에 이미 익숙해져 있고 그것이 가져다주는 편리함을 누리고 있다.

예를 들면 제네릭이 갑자기 나타나고, List 가 List<String> 으로 바뀌고,

틀에 박힌 Iterator 대신 for-each 루프를 사용할 수 있게 되었다.

고전적인 객체지향에서 벗어나 함수형 프로그래밍으로 다가섰다.

언어는 하드웨어나 프로그래머 기대의 변화에 부응하는 방향으로 변화해야 한다.

## 1.3 자바 함수

프로그래밍 언어에서 함수라는 용어는 메서드, 특히 정적 메서드와 같은 의미로 사용된다.

자바의 함수는 이에 더해 수학적인 함수처럼 사용되며 부작용을 일으키지 않는 함수를 의미한다.

자바 8에서는 함수를 새로운 값의 형식으로 추가했다.

프로그래밍 언어의 핵심은 값을 바꾸는 것이다.

역사적으로도, 전통적으로도 프로그래밍 언어에서는 이 값을 일급값 또는 일급시민으로 부른다.

프로그래밍을 실행하는 동안 모든 구조체를 자유롭게 전달할 수는 없는데

이렇게 전달할 수 없는 구조체는 이급 시민이다.

메서드, 클래스 등은 이급 자바 시민에 해당한다.

자바 8 설계자들은 이급 시민을 일급 시민으로 바꿀 수 있는 기능을 추가했다.

런타임에 메서드를 전달할 수 있다면 프로그래밍에 유용하게 활용할 수 있다.

### 1.3.1 메서드와 람다를 일급 시민으로

- 메서드 참조
    
    ![](https://github.com/L1LDB/L1LDB.github.io/blob/main/_posts/modern-java-in-action/chap1.-자바-8,-9,-10,-11-:-무슨-일이-일어나고-있는가?/2023-09-23-노경민/4.png)
    
    ![](https://github.com/L1LDB/L1LDB.github.io/blob/main/_posts/modern-java-in-action/chap1.-자바-8,-9,-10,-11-:-무슨-일이-일어나고-있는가?/2023-09-23-노경민/5.png)

    

자바 8에서는 메서드가 이급값이 아닌 일급값이다.

기존에 객체 참조를 이용하여 객체를 주고 받았던 것 처럼 `File::isHidden` 과 같이 메서드 참조를 만들어 전달할 수 있게 되었다.

- 람다 : 익명함수

람다를 포함한 함수도 일급값으로 취급할 수 있다.

![](https://github.com/L1LDB/L1LDB.github.io/blob/main/_posts/modern-java-in-action/chap1.-자바-8,-9,-10,-11-:-무슨-일이-일어나고-있는가?/2023-09-23-노경민/6.png)

### 1.3.2 코드 넘겨주기 : 예제

특정 항목을 선택해서 반환하는 동작을 필터라고 한다.

자바 8 이전에는 다음처럼 메서드를 구현했을 것이다.

![](https://github.com/L1LDB/L1LDB.github.io/blob/main/_posts/modern-java-in-action/chap1.-자바-8,-9,-10,-11-:-무슨-일이-일어나고-있는가?/2023-09-23-노경민/7.png)

누군가는 사과를 무게로 필터링하고 싶을 수도 있다.

![](https://github.com/L1LDB/L1LDB.github.io/blob/main/_posts/modern-java-in-action/chap1.-자바-8,-9,-10,-11-:-무슨-일이-일어나고-있는가?/2023-09-23-노경민/8.png)

이러한 변화는 보통 복사&붙여넣기로 이루어진다.

만약 어떤 코드에 버그가 있다면 복사 붙여넣기한 모든 코드를 고쳐야하는 단점이 있다.

![](https://github.com/L1LDB/L1LDB.github.io/blob/main/_posts/modern-java-in-action/chap1.-자바-8,-9,-10,-11-:-무슨-일이-일어나고-있는가?/2023-09-23-노경민/9.png)

자바 8에서는 코드를 인수로 넘겨줄 수 있고 Predicate 는 그 예시이다.

Predicate 는 수학에서 인수로 값을 받아 true 나 false 를 반환하는 함수이다.

### 1.3.3 메서드 전달에서 람다로

한 번만 사용할 메서드는 따로 정의를 구현할 필요가 없다.

이 때, 람다를 사용하여 간단히 해결할 수 있다.

![](https://github.com/L1LDB/L1LDB.github.io/blob/main/_posts/modern-java-in-action/chap1.-자바-8,-9,-10,-11-:-무슨-일이-일어나고-있는가?/2023-09-23-노경민/10.png)

다만 람다가 몇 줄 이상으로 길어진다면 이 코드가 수행하는 일을 잘 설명하는 메서드를 정의하고 메서드 참조를 사용하는 것이 바람직하다.

## 1.4 스트림

거의 모든 자바 어플리케이션은 컬렉션을 만들고 활용한다.

예를 들어 리스트에서 고가의 거래만 필터링한 다음 통화로 결과를 그룹핑해야 한다고 하자.

![](https://github.com/L1LDB/L1LDB.github.io/blob/main/_posts/modern-java-in-action/chap1.-자바-8,-9,-10,-11-:-무슨-일이-일어나고-있는가?/2023-09-23-노경민/11.png)

코드를 한 번에 이해하기 어렵다.

스트림 API 를 이용하면 해결할 수 있다.

![](https://github.com/L1LDB/L1LDB.github.io/blob/main/_posts/modern-java-in-action/chap1.-자바-8,-9,-10,-11-:-무슨-일이-일어나고-있는가?/2023-09-23-노경민/12.png)

- 외부 반복 : 컬렉션에서는 for-each 루프를 이용하여 각 요소를 반복하며 작업을 수행했다.
- 내부 반복 : 스트림 API 에서는 라이브러리 내부에서 모든 데이터가 처리된다.

### 1.4.1 멀티스레딩은 어렵다

멀티스레딩 환경에서 각각의 스레드는 동시에 공유된 데이터에 접근하고 데이터를 갱신할 수 있다.

하지만 스레드를 잘못 제어하면 원치 않은 방식으로 데이터가 바뀔 수 있다.

![](https://github.com/L1LDB/L1LDB.github.io/blob/main/_posts/modern-java-in-action/chap1.-자바-8,-9,-10,-11-:-무슨-일이-일어나고-있는가?/2023-09-23-노경민/13.png)

자바 8은 스트림에서 멀티코어 활용 어려움에 대한 문제를 또한 해결했다.

![](https://github.com/L1LDB/L1LDB.github.io/blob/main/_posts/modern-java-in-action/chap1.-자바-8,-9,-10,-11-:-무슨-일이-일어나고-있는가?/2023-09-23-노경민/14.png)

1. 데이터를 분리해 하나의 CPU 는 앞부분, 다른 CPU 는 뒷 부분을 처리하도록 한다. 이를 포킹 단계라고 한다.
2. 각 CPU가 데이터를 처리한다.
3. 결과를 하나로 정리한다.

![](https://github.com/L1LDB/L1LDB.github.io/blob/main/_posts/modern-java-in-action/chap1.-자바-8,-9,-10,-11-:-무슨-일이-일어나고-있는가?/2023-09-23-노경민/15.png)

parallelStream 으로 병렬 처리를 요청할 수 있다.

## 1.5 디폴트 메서드와 자바 모듈

자바 8에서는 인터페이스를 쉽게 바꿀 수 있도록 디폴트 메서드를 지원한다.

자바 8 이전에는 List<T> 가 Stream 이나 parallelStream 메서드를 지원하지 않는다.

즉 바뀐 자바 8에서는 이전 코드에 Stream 을 추가하여 컴파일 할 수가 없다.

이미 컬렉션 API의 인터페이스를 구현하는 많은 컬렉션 프레임워크가 존재하는 것도 문제다.

그래서 구현 클래스에서 구현하지 않아도 되는 메서드를 인터페이스에 추가하는 기능을 추가했다.

디폴트 메서드를 이용하면 기존 코드를 건드리지 않고도 원래의 인터페이스 설계를 자유롭게 확장한다.

![](https://github.com/L1LDB/L1LDB.github.io/blob/main/_posts/modern-java-in-action/chap1.-자바-8,-9,-10,-11-:-무슨-일이-일어나고-있는가?/2023-09-23-노경민/16.png)

자바 8에서는 List 에서 직접 sort 를 호출할 수 있다.

이러한 default 메서드가 추가되었기 때문이다.

## 1.6 함수형 프로그래밍에서 가져온 다른 유용한 아이디어

자바 8에서는 NPE를 회피할 수 있게 도와주는 Optional<T> 클래스를 제공한다.

Optional 은 값이 없는 상황을 어떻게 처리할지 명시적으로 구현하는 메서드를 가지고 있다.