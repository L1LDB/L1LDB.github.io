---
title: π£ 8. Thread & Lock
author: olive-su
date: 2023-12-17 20:00:00 +09:00
categories: [μ½”λ”© μΈν„°λ·° λ€ν•™, 8. Thread & Lock]
tags: [μ½”λ”© μΈν„°λ·° λ€ν•™, μ΄μμ²΄μ , 9μ£Όμ°¨, κΉ€μκ²½]
render_with_liquid: false
math: true
---

- κµμ°© μƒνƒ(deadlock)μ— λ€ν• μΌλ°μ μΈ μ΄ν•΄λ„ ν‰κ°€

# μλ°”μ μ¤λ λ“

- λ¨λ“  μ¤λ λ“λ” `java.lang.Thread` ν΄λμ¤ κ°μ²΄μ— μν•΄ μƒμ„±/μ μ–΄
- λ…λ¦½μ μΈ μ‘μ© ν”„λ΅κ·Έλ¨μ΄ μ‹¤ν–‰λ  λ•, `main()` λ©”μ„λ“λ¥Ό μ‹¤ν–‰ν•κΈ° μ„ν• ν•λ‚μ μ‚¬μ©μ μ¤λ λ“λ¥Ό **μ£Ό μ¤λ λ“(main thread)**λΌκ³  λ¶€λ¥Έλ‹¤.

- μλ°”μ—μ„ μ¤λ λ“λ¥Ό κµ¬ν„ν•λ” λ°©λ²•
  - `java.lang.Runnable` μΈν„°νμ΄μ¤ κµ¬ν„
  - `java.lang.Thread` ν΄λμ¤ μƒμ†

### Runnable μΈν„°νμ΄μ¤λ¥Ό κµ¬ν„ν•λ” λ°©λ²•

- Runnable μΈν„°νμ΄μ¤

  ```java
  public interface Runnable {
  		void run();
  }
  ```

- `Runnable` μΈν„°νμ΄μ¤λ¥Ό κµ¬ν„ν•λ” ν΄λμ¤ μƒμ„±
  - ν•΄λ‹Ή ν΄λμ¤μ κ°μ²΄λ” `Runnable` κ°μ²΄κ°€ λ¨
- `Thread` νƒ€μ…μ κ°μ²΄λ¥Ό λ§λ“¤ λ•, `Thread` μƒμ„±μμ— `Runnable` κ°μ²΄λ¥Ό μΈμλ΅ λ„κΈ΄λ‹¤.
- μ΄μ „ λ‹¨κ³„μ—μ„ μƒμ„±ν• Thread κ°μ²΄μ `start()` λ©”μ„λ“λ¥Ό νΈμ¶ν•λ‹¤.

### Thread ν΄λμ¤ μƒμ†

- `Thread` ν΄λμ¤λ¥Ό μƒμ†λ°›μ•„μ„ μ¤λ λ“λ¥Ό λ§λ“¤ μ λ„ μλ‹¤.
- κ±°μ ν•­μƒ `run()` λ©”μ„λ“λ¥Ό μ¤λ²„λΌμ΄λ“ν•΄μ•Όν•λ©° ν•μ„ ν΄λμ¤μ μƒμ„±μλ” μƒμ„ ν΄λμ¤μ μƒμ„±μλ¥Ό λ…μ‹μ μΌλ΅ νΈμ¶ν•΄μ•Όν•λ‹¤.

### Thread μƒμ† π†Β Runnable μΈν„°νμ΄μ¤ κµ¬ν„

- `Runnable` μΈν„°νμ΄μ¤λ¥Ό κµ¬ν„ν•λ” κ² `Thread` μƒμ†λ³΄λ‹¤ μ„ νΈλλ” μ΄μ  ?
  - μλ°”λ” λ‹¤μ¤‘ μƒμ†μ„ μ§€μ›ν•μ§€ μ•μ
    β‡’ Thread ν΄λμ¤λ¥Ό μƒμ†ν•κ² λλ©΄ ν•μ„ ν΄λμ¤λ” λ‹¤λ¥Έ ν΄λμ¤λ¥Ό μƒμ†ν•  μ μ—†μ

# λ™κΈ°ν™”μ™€ λ½

- ν”„λ΅μ„Έμ¤ μ•μ—μ„ μƒμ„±λ μ¤λ λ“λ“¤μ€ κ°™μ€ λ©”λ¨λ¦¬ κ³µκ°„μ„ κ³µμ 
- λ‘ μ¤λ λ“κ°€ κ°™μ€ μμ›μ„ λ™μ‹μ— λ³€κ²½ν•λ” κ²½μ° β†’ λ¬Έμ  λ°μƒ

- κ³µμ  μμ›μ— λ€ν• μ ‘κ·Ό μ μ–΄
  - λ™κΈ°ν™” μ μ©

### λ™κΈ°ν™”λ λ©”μ„λ“

- `synchronized` ν‚¤μ›λ“ : κ³µμ  μμ›μ— λ€ν• μ ‘κ·Ό μ μ–΄
- ν‚¤μ›λ“λ” λ©”μ„λ“μ— μ μ©

### λ™κΈ°ν™”λ λΈ”λ΅

- νΉμ • μ½”λ“ λΈ”λ΅ λ™κΈ°ν™”
- λ©”μ„λ“ λ™κΈ°ν™”μ™€ μ•„μ£Ό λΉ„μ·ν•κ² λ™μ‘

```java
public class MyClass extends Thread {
	...
	public void run() {
			myObj.foo(name);
	}
}

public class MyObject {
	public void foo(String name){
			synchronized(this) {
					...
			}
	}
}
```

- ν•λ‚μ μ¤λ λ“λ§μ΄ `synchronized` λΈ”λ΅ μ•μ μ½”λ“ μ‹¤ν–‰ κ°€λ¥

### λ½

- μΆ€ λ” μ„Έλ°€ν•κ² λ™κΈ°ν™” μ μ–΄ β†’ λ½(lock) μ‚¬μ©
- λ½ = λ¨λ‹ν„°

### κµμ°©μƒνƒμ™€ κµμ°©μƒνƒ λ°©μ§€

- κµμ°©μƒνƒ λ°μƒ μ΅°κ±΄
  - μƒν¬λ°°μ 
  - λ€κΈ°
  - μ„ μ  λ¶κ°€λ¥
  - λ€κΈ° μƒνƒμ μ‚¬μ΄ν΄
