---
title: ğŸ¦Š 7. Database
author: gengminy
date: 2023-12-03 20:00:00 +09:00
categories: [ì½”ë”© ì¸í„°ë·° ëŒ€í•™, 7. Database]
tags: [ì½”ë”© ì¸í„°ë·° ëŒ€í•™, ì¶”ê°€ ì§€ì‹, 8ì£¼ì°¨, ë…¸ê²½ë¯¼]
render_with_liquid: false
math: true
---

# 7. Database

# SQL ë¬¸ì ‘ê³¼ ê·¸ ë³€ì¢…ë“¤

- ëª…ì‹œì  JOIN

```java
SELECT CourseName, TeacherName
FROM Courses INNER JOIN Teachers
ON Courses.TeacherID = Teachers.TeacherID
```

- ë¬µì‹œì  JOIN

```java
SELECT CourseName, TeacherName
FROM Courses, Teachers
WHERE Courses.TeacherID = Teachers.TeacherID
```

ì´ ë‘˜ì€ ë™ë“±í•˜ë‹¤. ì–´ëŠ ìª½ì„ ì‚¬ìš©í•  ê²ƒì´ëƒ í•˜ëŠ” ê²ƒì€ ê°œì¸ ì·¨í–¥ì˜ ë¬¸ì œì´ë‹¤.

# ë¹„ì •ê·œí™” vs. ì •ê·œí™” ë°ì´í„°ë² ì´ìŠ¤

- ì •ê·œí™” ë°ì´í„°ë² ì´ìŠ¤ : ì¤‘ë³µì„ ìµœì†Œí™”í•˜ë„ë¡ ì„¤ê³„ë¨
- ë¹„ì •ê·œí™” ë°ì´í„°ë² ì´ìŠ¤ : ì½ëŠ” ì‹œê°„ì„ ìµœì í™”í•˜ë„ë¡ ì„¤ê³„ë¨

Courses ë‚˜ Teachers ì™€ ê°™ì€ ìë£Œë¥¼ í¬í•¨í•˜ëŠ” ì „í˜•ì ì¸ ì •ê·œí™” DBëŠ” ì™¸ë˜í‚¤ë¥¼ ê°–ì€ ì»¬ëŸ¼ì´ ìˆë‹¤.

ì´ ì„¤ê³„ì˜ ì¥ì ì€ êµì‚¬ ì •ë³´ë¥¼ DBì— í•œ ë²ˆë§Œ ì €ì¥í•´ë„ ëœë‹¤ëŠ” ê²ƒì´ë‹¤.

ë°˜ë©´ ìƒë‹¹ìˆ˜ì˜ ì¼ìƒì  ì§ˆì˜ë¥¼ ì²˜ë¦¬í•˜ê¸° ìœ„í•´ JOINì„ ë§ì´ í•˜ê²Œ ë˜ëŠ” ë‹¨ì ì´ ìˆë‹¤.

ë¹„ì •ê·œí™” DBì—ì„œëŠ” ë°ì´í„°ë¥¼ ì¤‘ë³µí•´ì„œ ì €ì¥í•  ìˆ˜ ìˆë‹¤.

ê°™ì€ ì§ˆì˜ë¥¼ ìì£¼ ë°˜ë³µí•´ì•¼ í•œë‹¤ëŠ” ì‚¬ì‹¤ì„ ë¯¸ë¦¬ ì•Œê³  ìˆìœ¼ë©´, êµì‚¬ì˜ ì´ë¦„ ì •ë³´ë¥¼ Courses í…Œì´ë¸”ì— ì¤‘ë³µí•´ ì €ì¥í•  ìˆ˜ë„ ìˆë‹¤.

ë†’ì€ ê·œëª¨ í™•ì¥ì„±ì„ ì‹¤í˜„í•˜ê¸° ìœ„í•´ ìì£¼ ì‚¬ìš©ë˜ëŠ” ê¸°ë²•ì´ë‹¤.

# SQL ë¬¸

```java
Courses: CourseID*, CourseName, TeacherID
Teachers: TeacherID*, TeacherName
Students: StudentID*, StudentName
StudentCourses: CourseID*, StudentID*
```

### ì§ˆì˜ #1: í•™ìƒ ë“±ë¡

ëª¨ë“  í•™ìƒì„ ë½‘ê³  ê° í•™ìƒì´ ì–¼ë§ˆë‚˜ ë§ì€ ê°•ì˜ë¥¼ ìˆ˜ê°•í•˜ê³  ìˆëŠ”ì§€ í™•ì¸í•˜ëŠ” ì§ˆì˜ë¬¸ì„ ë§Œë“¤ì–´ë³´ì.

- ë‹¤ë¥¸ ì§ˆì˜ë¬¸ìœ¼ë¡œ ê°ì‹¸ê¸°

```java
SELECT StudentName, Students.StudentID, Cnt
FROM (
	SELECT Students.StudentID, count(StudentCourses.CourseID) as [cnt]
	FROM Students LEFT JOIN StudentCourses
	ON Students.StudentID = StudentCourses.StudentID
	GROUP BY Students.StudentID
) T INNER JOIN Sudents on T.studentID = Students.StudentID
```

- StudentNAme ì„ GROUP BY ì ˆì— ì¶”ê°€í•˜ê¸°

```java
SELECT StudentName, Students.StudentID, count(StudentCourses.CourseID) as [cnt]
FROM Students LEFT JOIN StudentCourses
ON Students.StudentID = StudentCourses.StudentID
GROUP BY Students.StudentID, Students.StudentName
```

- ì§‘í•© í•¨ìˆ˜ë¡œ ê°ì‹¸ê¸°

```java
SELECT max(StudentName) as [StudentName], Students.StudentID,
									count(StudentCourses.CourseID) as [count]
FROM Students LEFT JOIN StudentCourses
ON Students.StudentID = StudentCourses.StudentID
GROUP BY Students.StudentID
```

### ì§ˆì˜ #2: ìˆ˜ê°•ìƒ ìˆ˜ êµ¬í•˜ê¸°

```java
SELECT TeacherName, isnull(StudentSize.Number, 0)
FROM Teachers LEFT JOIN
	(SELECT TeacherID, count(StudentCourses.CourseID) AS [Number]
		FROM Courses INNER JOIN StudentCourses
		ON Courses.CourseID = StudnetCourses
		GROUP BY Courses.TeacherID) StudentSize
ON Teachers.TeacherID = StudentSize.TeacherID
ORDER BY StudentSize.Number DESC
```

# ì†Œê·œëª¨ ë°ì´í„°ë² ì´ìŠ¤ ì„¤ê³„

### 1ë‹¨ê³„: ëª¨í˜¸ì„± ì²˜ë¦¬

ì„¤ê³„ë¥¼ ì‹œì‘í•˜ê¸° ì „ì— ì •í™•íˆ ë¬´ì—‡ì„ ì„¤ê³„í•´ì•¼ í•˜ëŠ”ì§€ ì´í•´í•´ì•¼ í•œë‹¤.

### 2ë‹¨ê³„: í•µì‹¬ ê°ì²´ ì •ì˜

ê·¸ ë‹¤ìŒìœ¼ë¡œ, ì´ ì‹œìŠ¤í…œì˜ í•µì‹¬ ê°ì²´ê°€ ë¬´ì—‡ì¸ì§€ ì‚´í´ë³¸ë‹¤.

í•µì‹¬ ê°ì²´ í•˜ë‚˜ë‹¹ ë³´í†µ í•˜ë‚˜ì˜ í…Œì´ë¸”ì„ ì‚¬ìš©í•œë‹¤.

### 3ë‹¨ê³„: ê´€ê³„ ë¶„ì„

í•µì‹¬ ê°ì²´ì˜ ìœ¤ê³½ì„ ì¡ê³  ë‚˜ë©´ í…Œì´ë¸”ë¼ë¦¬ ì–´ë–¤ ê´€ê³„ê°€ ìˆì„ì§€ ì‚´í´ë³¸ë‹¤.

### 4ë‹¨ê³„: í–‰ìœ„ ì¡°ì‚¬

í”í•˜ê²Œ ìˆ˜í–‰ë  ì‘ì—…ë“¤ì„ ì‚´í´ë³´ê³  ê´€ë ¨ëœ ë°ì´í„°ë¥¼ ì–´ë–»ê²Œ ì €ì¥í•˜ê³  ê°€ì ¸ì˜¬ ê²ƒì¸ì§€ ì´í•´í•´ì•¼ í•œë‹¤.

# ëŒ€ê·œëª¨ ë°ì´í„°ë² ì´ìŠ¤ ì„¤ê³„

ëŒ€ê·œëª¨ì˜ ê·œëª¨ í™•ì¥ì„±ì´ ë†’ì€ DBë¥¼ ì„¤ê³„í•  ë•Œì— JOIN ì—°ì‚°ì€ ì¼ë°˜ì ìœ¼ë¡œ ì•„ì£¼ ëŠë¦¬ë‹¤ê³  ê°„ì£¼í•´ì•¼ í•œë‹¤.

ë”°ë¼ì„œ ë°ì´í„°ë¥¼ ë¹„ì •ê·œí™”í•´ì•¼ í•œë‹¤.

# ë©´ì ‘ ë¬¸ì œ

### 14.1 í•˜ë‚˜ ì´ìƒì˜ ì§‘

í•˜ë‚˜ ì´ìƒì˜ ì§‘ì„ ëŒ€ì—¬í•œ ëª¨ë“  ê±°ì£¼ìì˜ ëª©ë¡ì„ êµ¬í•˜ëŠ” SQL ì§ˆì˜ë¬¸ì„ ì‘ì„±í•˜ë¼.

```java
SELECT *
FROM Tenants
INNER JOIN TenantApartments
ON Tenants.TenantID = TenantApartments
GROUP BY Tenents.TenentID
```

### 14.2 Open ìƒíƒœì¸ Request

ëª¨ë“  ê±´ë¬¼ ëª©ë¡ê³¼ Status ê°€ Open ì¸ ëª¨ë“  Request ê°œìˆ˜ë¥¼ êµ¬í•˜ë¼.

```java
SELECT Buildings.BuildingName, count(*) as [cnt]
FROM Buildings
INNER JOIN Requests
ON Buildings.BuildingID = Requests.BuildingID
	and Requests.status = 'Open'
GROUP BY Building.BuildingID
```

### 14.3 Request ë¥¼ Closeë¡œ ë°”ê¾¸ê¸°

11ë²ˆ ë¹Œë”©ì—ì„œ ëŒ€ê·œëª¨ ë¦¬ëª¨ë¸ë§ ê³µì‚¬ë¥¼ ì§„í–‰ ì¤‘ì´ë‹¤.

ì´ ê±´ë¬¼ì— ìˆëŠ” ëª¨ë“  ì§‘ì— ëŒ€í•œ ëª¨ë“  Request ì˜ Status ë¥¼ Close ë¡œ ë³€ê²½í•´ì£¼ëŠ” ì§ˆì˜ë¬¸ì„ ì‘ì„±í•˜ë¼.

```java
UPDATE Requests
SET Status = 'Close'
WHERE Requests.BuildingID = 11
```

### 14.4 JOIN

ì„œë¡œ ë‹¤ë¥¸ ì¢…ë¥˜ì˜ JOIN ì€ ì–´ë–¤ ê²ƒë“¤ì´ ìˆëŠ”ê°€? ê°ê°ì´ ì–´ë–»ê²Œ ë‹¤ë¥´ê³ , ì–´ë–¤ ìƒí™©ì—ì„œ ì–´ë–¤ JOIN ê³¼ ì–´ìš¸ë¦¬ëŠ”ì§€ ì„¤ëª…í•˜ë¼.

- LEFT JOIN : ê¸°ì¤€ í…Œì´ë¸”ì—ì„œ ë§¤í•‘ë˜ëŠ” ë°ì´í„°ë¥¼ ë¶™ì„, ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ë°ì´í„°ëŠ” NULL ì²˜ë¦¬
- RIGHT JOIN : ìƒëŒ€ í…Œì´ë¸”ì—ì„œ ë§¤í•‘ë˜ëŠ” ë°ì´í„°ë¥¼ ê°€ì ¸ì˜´. ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ê¸°ì¤€ ë°ì´í„°ëŠ” NULL ì²˜ë¦¬
- INNER JOIN : êµì§‘í•©, ì„œë¡œ ë§¤í•‘ë˜ëŠ” ê²ƒë§Œ ì¡°íšŒ, ë‚˜ë¨¸ì§€ëŠ” ì‚¬ë¼ì§
- FULL JOIN : í•©ì§‘í•©, ë‘ ë°ì´í„°ë¥¼ ëª¨ë‘ ê°€ì ¸ì˜´

### 14.5 ë¹„ì •ê·œí™”

ë¹„ì •ê·œí™”ë€ ë¬´ì—‡ì¸ê°€? ê·¸ ì¥ë‹¨ì ì„ ì„¤ëª…í•˜ë¼.

DB ì—ì„œì˜ ì¤‘ë³µìœ¼ë¡œ ì¡´ì¬í•˜ëŠ” ë°ì´í„°ë¥¼ í—ˆìš©í•¨

ë°ì´í„°ì˜ ì¤‘ë³µìœ¼ë¡œ ì¼ê´€ì„±ì´ ì—†ì–´ì§ˆ ìˆ˜ ìˆì§€ë§Œ, JOIN ì„ í•˜ì§€ ì•Šì•„ ì½ê¸° ì„±ëŠ¥ì´ í–¥ìƒë¨.

### 14.6 ê°œì²´-ê´€ê³„ ë‹¤ì´ì–´ê·¸ë¨

íšŒì‚¬, ì‚¬ëŒ, ì§ì›ìœ¼ë¡œ êµ¬ì„±ëœ ë°ì´í„°ë² ì´ìŠ¤ì˜ ER ë‹¤ì´ì–´ê·¸ë¨ì„ ê·¸ë ¤ë¼.

```java
companyID   BIGINT
companyName VARCHAR(50)

personID    BIGINT
personeName VARCHAR(50)

employee    BIGINT
employeeName VARCHAR(50)
```
