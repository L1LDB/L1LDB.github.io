---
title: ğŸ¹ 7. Database
author: chaeshee0908
date: 2023-12-03 20:00:00 +09:00
categories: [ì½”ë”© ì¸í„°ë·° ëŒ€í•™, 7. Database]
tags: [ì½”ë”© ì¸í„°ë·° ëŒ€í•™, ì¶”ê°€ ì§€ì‹, 8ì£¼ì°¨, ì±„ìŠ¹í¬]
render_with_liquid: false
math: true
---

# 14. ë°ì´í„°ë² ì´ìŠ¤

## [ SQL ë¬¸ë²•ê³¼ ê·¸ ë³€ì¢…ë“¤ ]

- ëª…ì‹œì (explicit) JOIN

```sql
SELECT CourseName, TeacherName
FROM Course INNER JOIN Teachers
ON Courses.TeacherID = Teachers.TeacherID
```

- ë¬µì‹œì (implicit) JOIN

```sql
SELECT CourseName, TeacherName
FROM Courses, Teachers
WHERE Courses.TeacherID = Teachers.TeacherID
```

## [ ë¹„ì •ê·œí™”  vs  ì •ê·œí™” ë°ì´í„°ë² ì´ìŠ¤ ]

- **ì •ê·œí™” ë°ì´í„°ë² ì´ìŠ¤**
    
    : **ì¤‘ë³µì„ ìµœì†Œí™”**í•˜ë„ë¡ ì„¤ê³„ëœ ë°ì´í„°ë² ì´ìŠ¤ 
    
    - Coursesì—ëŠ” TeacherIDì²˜ëŸ¼ Teachersì— ëŒ€í•œ ì™¸ë˜í‚¤ë¥¼ ê°–ëŠ” ì»¬ëŸ¼ì´ ìˆì„ ê²ƒì´ë‹¤.
    - **ì¥ì **: êµì‚¬ ì •ë³´(ì´ë¦„, ì£¼ì†Œ ë“±ë“±)ë¥¼ **ë°ì´í„°ë² ì´ìŠ¤ì— í•œ ë²ˆë§Œ ì €ì¥**í•´ë„ ëœë‹¤.
    - **ë‹¨ì **: ìƒë‹¹ìˆ˜ì˜ ì¼ìƒì  ì§ˆì˜ë¥¼ ì²˜ë¦¬í•˜ê¸° ìœ„í•´ **JOINì„ ë§ì´ í•˜ê²Œ** ëœë‹¤.
- **ë¹„ì •ê·œí™” ë°ì´í„°ë² ì´ìŠ¤**
    
    : **ì½ëŠ” ì‹œê°„ì„ ìµœì í™”**í•˜ë„ë¡ ì„¤ê³„ëœ ë°ì´í„°ë² ì´ìŠ¤
    
    - ë°ì´í„°ë¥¼ **ì¤‘ë³µí•´ì„œ ì €ì¥**í•  ìˆ˜ ìˆë‹¤.
    - ë§Œì•½ **ê°™ì€ ì§ˆì˜ë¥¼ ìì£¼ ë°˜ë³µí•´ì•¼ í•œë‹¤ëŠ” ì‚¬ì‹¤ì„ ë¯¸ë¦¬ ì•Œê³  ìˆìœ¼ë©´**, êµì‚¬ì˜ ì´ë¦„ ì •ë³´ë¥¼ Courses í…Œì´ë¸”ì— ì¤‘ë³µí•´ ì €ì¥í•  ìˆ˜ë„ ìˆë‹¤.
    - **ë†’ì€ ê·œëª¨ í™•ì¥ì„±ì„ ì‹¤í˜„í•˜ê¸° ìœ„í•´ ìì£¼ ì‚¬ìš©ëœë‹¤.**

## [ SQLë¬¸ ]

ìœ„ ì˜ˆì œì˜ ë°ì´í„°ë² ì´ìŠ¤ êµ¬ì¡°ëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤.

```sql
Courses: CourseID*, CourseName, TeacherID
Teachers: TeacherID*, TeacherName
Students: StudentID*, StudentName
StudentCourses: CourseID*, StudentID*
```

ìœ„ í…Œì´ë¸”ì„ ì‚¬ìš©í•´ ì§ˆì˜ë¬¸ì„ êµ¬í˜„í•´ë³´ì. 

### ì§ˆì˜ #1: í•™ìƒ ë“±ë¡

- ëª¨ë“  í•™ìƒì˜ ëª©ë¡ì„ ë½‘ê³  ê° í•™ìƒì´ ì–¼ë§ˆë‚˜ ë§ì€ ê°•ì˜ë¥¼ ìˆ˜ê°•í•˜ê³  ìˆëŠ”ì§€ í™•ì¸í•˜ëŠ” ì§ˆì˜ë¬¸

```sql
/* ì˜ëª»ëœ ì½”ë“œ */
SELECT Students.StudentName, count(*)
FROM Students INNER JOIN StudentCourses
ON Students.StudentID = StudentCourses.StudentID
GROUP BY Students.StudentID
```

ì´ ì½”ë“œì—ëŠ” 3ê°€ì§€ ë¬¸ì œê°€ ìˆë‹¤.

1. **ê°•ì˜ë¥¼ ì•„ì˜ˆ ìˆ˜ê°•í•˜ì§€ ì•ŠëŠ” í•™ìƒì€ ëª©ë¡ì— í¬í•¨ë˜ì§€ ì•ŠëŠ”ë‹¤**. ì™œëƒí•˜ë©´ Student Coursesê°€ ìˆ˜ê°• ì‹ ì²­í•œ í•™ìƒë§Œì„ í¬í•¨í•˜ê¸° ë•Œë¬¸ì´ë‹¤. 
    
    â†’ **LEFT JOIN**ì„ ì‚¬ìš©í•˜ë„ë¡ ë³€ê²½í•´ì•¼ í•œë‹¤. 
    
2. LEFT JOINì„ í•˜ë„ë¡ ë³€ê²½í•´ë„ ë¬¸ì œê°€ ìˆë‹¤. count(*)ëŠ” StudentIDë¡œ ë§Œë“¤ì–´ì§„ ê·¸ë£¹ ë‚´ì— ì¡´ì¬í•˜ëŠ” ì•„ì´í…œì˜ ê°œìˆ˜ë¥¼ ì„¼ë‹¤. ë”°ë¼ì„œ **ê°•ì˜ë¥¼ ì•„ì˜ˆ ìˆ˜ê°•í•˜ì§€ ì•ŠëŠ” í•™ìƒì˜ ê²½ìš°ì—ë„ 1ë¡œ ê³„ì‚°ë˜ëŠ” ë¬¸ì œ**ê°€ ìˆë‹¤. 
    
    â†’ count(StudentsCourses.CourseID)ì™€ ê°™ì´ ê·¸ë£¹ ë‚´ì˜ CourseID ìˆ˜ë¥¼ ì„¸ë„ë¡ ë³€ê²½í•´ì•¼ í•œë‹¤. 
    
3. Students.StudentIDë¥¼ ì‚¬ìš©í•´ ê·¸ë£¹ì„ ë§Œë“¤ì—ˆì§€ë§Œ, ì—¬ì „íˆ í•œ ê·¸ë£¹ ì•ˆì— ì—¬ëŸ¬ ê°œì˜ StudentNameì´ ì¡´ì¬í•œë‹¤. ë°ì´í„°ë² ì´ìŠ¤ê°€ ì–´ë–¤ StudentNameì„ ë°˜í™˜í•´ì•¼ í•˜ëŠ”ì§€ ì•Œ ìˆ˜ ì—†ë‹¤. ëª¨ë‘ ê°™ì€ ê°’ì„ ê°€ì§„ë‹¤ í•´ë„ ë°ì´í„°ë² ì´ìŠ¤ëŠ” ê·¸ ì‚¬ì‹¤ì„ ì´í•´í•˜ì§€ ëª»í•  ê²ƒì´ë‹¤. 
    
    â†’ first(Students.StudentName)ê³¼ ê°™ì€ ì§‘ê³„ í•¨ìˆ˜(aggregate function)ë¥¼ ì‚¬ìš©í•  í•„ìš”ê°€ ìˆë‹¤. 
    

ìœ„ ë¬¸ì œë¥¼ ê³ ì³ ë‹¤ì‹œ ë§Œë“  ì§ˆì˜ë¬¸ì´ë‹¤. 

```sql
/* ì²« ë²ˆì§¸ í•´ë²•: ë‹¤ë¥¸ ì§ˆì˜ë¬¸ìœ¼ë¡œ ê°ì‹¸ê¸° */
SELECT StudentName, Student.StudentID, Cnt
FROM (
		SELECT Students.StudentID, count(StudentCourses.CourseID) as [Cnt]
		FROM Students LEFT JOIN StudentCourses
		ON Students.StudeentID = StudentCourses.StudentID
		GROUP BY Students.StudentID
) T INNER JOIN Students on T.StudentID = Students.StudentID
```

ìœ„ ì½”ë“œ 3ë²ˆì§¸ ì¤„ì—ì„œ ê·¸ëƒ¥ í•™ìƒ ì´ë¦„ì„ SELECTí•˜ë©´ 3~6ë²ˆ ì¤„ì—ì„œ ì²˜ëŸ¼ ë‹¤ë¥¸ ì§ˆì˜ë¬¸ìœ¼ë¡œ ê°ìŒ€ í•„ìš”ê°€ ì—†ì§€ ì•Šë‚˜ë¼ê³  ìƒê°í•  ìˆ˜ ìˆë‹¤. 

ì•„ë˜ ì½”ë“œëŠ” ë‹¤ì‹œ ë§Œë“¤ì–´ë³¸ ì˜ëª»ëœ í•´ê²°ì±… ì½”ë“œì´ë‹¤.

```sql
/* ì˜ëª»ëœ ì½”ë“œ */
SELECT StudentName, Students.StudentID, count(StudentCourses.CourseID) as [Cnt]
FROM Students LEFT JOIN StudentCourses
ON Students.StudentID = StudentCourses.StudentID
GROUP BY Students.StudentID
```

ì´ ì½”ë“œëŠ” ì´ì „ ì½”ë“œì™€ ì •í™•íˆ ê°™ì€ ê²°ê³¼ë¥¼ ë‚¼ ìˆ˜ ì—†ë‹¤. SELECTê°€ ê°€ëŠ¥í•œ ê²ƒì€ ì§‘ê³„ í•¨ìˆ˜ë‚˜ GROUP BY ì ˆì— í¬í•¨ëœ ê°’ ë¿ì´ë‹¤. 

ë‹¤ìŒê³¼ ê°™ì€ ë°©ë²•ì„ ì¨ì•¼í•œë‹¤.

```sql
/* ë‘ ë²ˆì§¸ í•´ë²•: StudentNameì„ GROUP BY ì ˆì— ì¶”ê°€í•˜ê¸° */
SELECT StudentName, Students.StudentID, count(StudentCourses.CourseID) as [Cnt]
FROM Students LEFT JOIN StudentCourses
ON Students.StudentID = StudentCourses.StudentID
GROUP BY Students.StudentID, Students.StudentName
```

ë˜ ë‹¤ë¥¸ í•´ë²•ì€ ë‹¤ìŒê³¼ ê°™ë‹¤. 

```sql
/* ì„¸ ë²ˆì§¸ í•´ë²•: ì§‘í•© í•¨ìˆ˜ë¡œ ê°ì‹¸ê¸° */
SELECT max(StudentName) as [StudentName], Students.StudentID, 
							count(StudentCourses.CourseID) as [Count]
FROM Students LEFT JOIN StudentCourses
ON Students.StudentID = StudentCourses.StudentID
GROUP BY Students.StudentID
```

### ì§ˆì˜ #2: ìˆ˜ê°•ìƒ ìˆ˜ êµ¬í•˜ê¸°

- ëª¨ë“  êµì‚¬ ëª©ë¡ê³¼ ê° êµì‚¬ê°€ ê°€ë¥´ì¹˜ëŠ” í•™ìƒ ìˆ˜ë¥¼ êµ¬í•˜ëŠ” ì§ˆì˜ë¬¸

ë§Œì•½ í•œ êµì‚¬ê°€ ë™ì¼í•œ í•™ìƒì„ ì—¬ëŸ¬ ê°•ì˜ì—ì„œ ê°€ë¥´ì¹˜ëŠ” ê²½ìš°, ê·¸ ê°ê°ì„ ë‹¤ë¥¸ í•™ìƒìœ¼ë¡œ ê°„ì£¼í•´ì„œ ê°€ë¥´ì¹˜ëŠ” í•™ìƒ ìˆ˜ì— í•©ì‚°í•œë‹¤. êµì‚¬ ë¦¬ìŠ¤íŠ¸ëŠ” ê° êµì‚¬ê°€ ê°€ë¥´ì¹˜ëŠ” í•™ìƒ ìˆ˜ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ë‚´ë¦¼ì°¨ìˆœ ì •ë ¬í•˜ë©´ ëœë‹¤. 

```sql
SELECT TeacherID, count(StudentCourses.CourseID) AS [Number]
FROM Courses INNER JOIN StudentCourses
ON Courses.CourseID = StudentCourses.CourseID
GROUP BY Courses.TeacherID
```

INNER JOINì„í•˜ê²Œ ë˜ë©´ ê°•ì˜ë¥¼ í•˜ì§€ ì•ŠëŠ” êµì‚¬ëŠ” ëª©ë¡ì— í¬í•¨ë˜ì§€ ì•ŠëŠ”ë‹¤. ë‹¤ìŒê³¼ ê°™ì´ LEFT JOINì„ í•˜ë©´ ëª¨ë“  êµì‚¬ ëª©ë¡ì„ ì–»ì„ ìˆ˜ ìˆë‹¤. 

```sql
SELECT TeacherName, isnull(StudentSize.Number, 0)
FROM Teachers LEFT JOIN
		(SELECT TeacherID, count(StudentCourses.CourseID) AS [Number]
		FROM Courses INNER JOIN StudentCourses
		ON Courses.CourseID = StudentCourses.CourseID
		GROUP BY Courses.TeacherID) StudentSize
ON Teachers.TeacherID = StudentSize.TeacherID
ORDER BY StudentSize.Number DESC
```

NULLê°’ì„ 0ìœ¼ë¡œ ë³€í™˜í•˜ê¸° ìœ„í•´ SELECT ë¬¸ì—ì„œ isnullì„ ì‚¬ìš©í•œë‹¤. 

- **isnull(a, b)**:  NULLì´ ì•„ë‹ ë•Œ ê°’ a, NULLì¼ ë•Œ ê°’ b

## [ ì†Œê·œëª¨ ë°ì´í„°ë² ì´ìŠ¤ ì„¤ê³„ ]

ë©´ì ‘ì¥ì—ì„œ ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ì„¤ê³„í•´ë³´ë¼ëŠ” ìš”ì²­ì„ ë°›ì•˜ì„ ë•Œ! ì ‘ê·¼ë²•!

ê°ì²´ ì§€í–¥ ì„¤ê³„ì™€ ë¹„ìŠ·í•œ ì ì´ ë§ë‹¤.

### 1ë‹¨ê³„: ëª¨í˜¸ì„± ì²˜ë¦¬

ë°ì´í„°ë² ì´ìŠ¤ì— ê´€ë ¨ëœ ë¬¸ì œì—ëŠ” ëª¨í˜¸í•œ ë¶€ë¶„ì´ ë‚´í¬ë˜ì–´ ìˆë‹¤. ì •í™•íˆ ë¬´ì—‡ì„ ì„¤ê³„í•´ì•¼ í•˜ëŠ”ì§€ ì´í•´í•´ì•¼ í•œë‹¤. 

[ ì•„íŒŒíŠ¸ ì„ëŒ€ ëŒ€í–‰ì—…ì²´ê°€ ì‚¬ìš©í•  ì‹œìŠ¤í…œì„ ì„¤ê³„ ]

- ì´ ì—…ì²´ì˜ ëŒ€ë¦¬ì ì´ ì—¬ëŸ¬ ê°œì¸ì§€ ì•„ë‹ˆë©´ í•˜ë‚˜ë§Œ ìˆëŠ”ì§€ ì•Œê³  ìˆì–´ì•¼ í•œë‹¤.
- ì–¼ë§ˆë‚˜ ì¼ë°˜ì ìœ¼ë¡œ ì„¤ê³„í•´ì•¼ í•˜ëŠ”ì§€ ë©´ì ‘ê´€ê³¼ ë…¼ì˜í•´ì•¼ í•œë‹¤.
- ex) ì–´ë–¤ ì‚¬ëŒì´ ê°™ì€ ë¹Œë”©ì— ìˆëŠ” ì§‘ì„ ë‘ ê°œ ë¹Œë¦¬ëŠ” ì¼ì€ êµ‰ì¥íˆ ë“œë¬¼ë‹¤. í•˜ì§€ë§Œ ê·¸ë ‡ë‹¤ê³  í•´ì„œ ê·¸ëŸ° ê²½ìš°ë¥¼ ì²˜ë¦¬í•  ìˆ˜ ì—†ì–´ì•¼ í•œë‹¤ëŠ” ê²ƒì€ ì•„ë‹ˆë‹¤. ê·¸ëŸ´ ìˆ˜ë„ ìˆê³ , ì•„ë‹ ìˆ˜ë„ ìˆë‹¤.
    
    â†’ ë“œë¬¼ê²Œ ìƒê¸°ëŠ” ì¼ì€ ë³„ë„ì˜ ë°©ì‹ì„ ì‚¬ìš©í•´ì„œ, ì¦‰ ë°ì´í„°ë² ì´ìŠ¤ì— ë³´ê´€ëœ ê·¸ ì‚¬ëŒì˜ ê°œì¸ ì •ë³´ë¥¼ ë³µì‚¬í•œë‹¤ê±°ë‚˜ í•´ì„œ í•´ê²°í•  ìˆ˜ë„ ìˆë‹¤. 
    

### 2ë‹¨ê³„: í•µì‹¬ ê°ì²´ ì •ì˜

ê·¸ ë‹¤ìŒìœ¼ë¡œëŠ”, ì´ ì‹œìŠ¤í…œì˜ **í•µì‹¬ ê°ì²´(core object)ê°€ ë¬´ì—‡ì¸ì§€** ì‚´í´ë´ì•¼ í•œë‹¤. ë³´í†µ í•µì‹¬ ê°ì²´ í•˜ë‚˜ë‹¹ í•˜ë‚˜ì˜ í…Œì´ë¸”ì„ ì‚¬ìš©í•œë‹¤. 

ì•„íŒŒíŠ¸ ì„ëŒ€ ëŒ€í–‰ì—…ì²´ì˜ ê²½ìš° Property, Building, Apartment, Tenant, Manager ë“±ì´ í•µì‹¬ ê°ì²´ê°€ ë  ìˆ˜ ìˆë‹¤. 

### 3ë‹¨ê³„: ê´€ê³„ ë¶„ì„

í•µì‹¬ ê°ì²´ì˜ ìœ¤ê³½ì„ ì¡ê³ ë‚˜ë©´ ì–´ë–»ê²Œ í…Œì´ë¸”ì„ ì„¤ê³„í•´ì•¼ í• ì§€ ê°ì„ ì¡ì„ ìˆ˜ ìˆì„ ê²ƒì´ë‹¤. í…Œì´ë¸”ë¼ë¦¬ ì–´ë–¤ ê´€ê³„ê°€ ìˆì„ ì§€(ë‹¤ëŒ€ë‹¤, ì¼ëŒ€ë‹¤ ë“±) ìƒê°í•´ì•¼ í•œë‹¤. 

Buildingsì™€ Apartmentsì˜ ê´€ê³„ê°€ ì¼-ëŒ€-ë‹¤ ê´€ê³„ë¼ë©´, ë‹¤ìŒê³¼ ê°™ì´ í‘œí˜„í•  ìˆ˜ ìˆë‹¤.

| Apartments | s |
| --- | --- |
| ApartmentID | int |
| ApartmentAddress | varchar(100) |
| BuildingID | int |

| Buildings | s |
| --- | --- |
| BuildingID | int |
| BuildingName | varchar(100) |
| BuildidngAddress | varchar(500) |

Apartments í…Œì´ë¸”ê³¼ Buildings í…Œì´ë¸”ì€ BuildingIDë¥¼ í†µí•´ ì—°ê²°ëœë‹¤. 

í•œ ì‚¬ëŒì´ í•˜ë‚˜ ì´ìƒì˜ ì•„íŒŒíŠ¸ë¥¼ ì„ëŒ€í•  ìˆ˜ ìˆë„ë¡ í•˜ê³  ì‹¶ë‹¤ë©´, ë‹¤ìŒê³¼ ê°™ì´ ë‹¤-ëŒ€-ë‹¤ ê´€ê³„ë¥¼ êµ¬í˜„í•˜ë©´ ëœë‹¤. 

| TenantApartments | s |
| --- | --- |
| TenantID | int |
| ApartmentID | int |

| Apartments | s |
| --- | --- |
| ApartmentID | int |
| ApartmentAddress | varchar(100) |
| BuildingID | int |

| Tenants | s |
| --- | --- |
| TenantID | int |
| TenantName | varchar(100) |
| TenantAddress | varchar(500) |

TenantApartments í…Œì´ë¸”ì€ Tenantsì™€ Apartments ì‚¬ì´ì˜ ê´€ê³„ë¥¼ ì €ì¥í•˜ê³  ìˆë‹¤. 

### 4ë‹¨ê³„: í–‰ìœ„ ì¡°ì‚¬

ë§ˆì§€ë§‰ìœ¼ë¡œ ì„¸ë¶€ì ì¸ ë¶€ë¶„ì„ ì±„ì›Œ ë„£ì–´ì•¼ í•œë‹¤. í”íˆ ìˆ˜í–‰ëœ ì‘ì—…ë“¤ì„ ì‚´í´ë³´ê³ , ê´€ë ¨ëœ ë°ì´í„°ë¥¼ ì–´ë–»ê²Œ ì €ì¥í•˜ê³  ê°€ì ¸ì˜¬ ê²ƒì¸ì§€ ì´í•´í•´ì•¼ í•œë‹¤. 

ì„ëŒ€ì™€ ê´€ê³„ëœ ìš©ì–´ë“¤ í‡´ê±°(moving out)ë‚˜ ì„ëŒ€ë¹„(rent payments)ì™€ ê°™ì€ ê²ƒë“¤ì„ ì²˜ë¦¬í•´ì•¼ í•œë‹¤. ì´ëŸ° ì‘ì—…ë“¤ì„ ì²˜ë¦¬í•˜ë ¤ë©´ ìƒˆë¡œìš´ í…Œì´ë¸”ì´ í•„ìš”í•˜ë‹¤. 

## [ ëŒ€ê·œëª¨ ë°ì´í„°ë² ì´ìŠ¤ ì„¤ê³„ ]

**ëŒ€ê·œëª¨ì˜ ê·œëª¨ í™•ì¥ì„±ì´ ë†’ì€ ë°ì´í„°ë² ì´ìŠ¤**ë¥¼ ì„¤ê³„í•  ë•Œì— **JOIN ì—°ì‚°(ì•ì„  ì˜ˆì œ)ì€ ì¼ë°˜ì ìœ¼ë¡œ ì•„ì£¼ ëŠë¦¬ë‹¤**ê³  ê°„ì£¼í•´ì•¼ í•œë‹¤. 

ë”°ë¼ì„œ ë°ì´í„°ë¥¼ **ë¹„ì •ê·œí™”(denormalize)**í•´ì•¼ í•œë‹¤.